import{u as S,a2 as C,r,j as e,f as E,a1 as W,a3 as _,a4 as w,a5 as X,e as $,E as J,a6 as H,a7 as B}from"./index-BEi8WKuF.js";import{L as Y}from"./Layout-Dj9Dgcds.js";const Z=({inCart:i=!1,onSwitchForm:b,onShowForgotPassword:j,onGoogleSuccess:f,onGoogleError:o})=>{const d=S(),{login:g}=C(),[m,t]=r.useState(!1),[u,a]=r.useState(""),[x,s]=r.useState({email:"",password:""}),p=n=>{const{name:h,value:v}=n.target;s({...x,[h]:v})},c=async n=>{var h,v,l,k;n.preventDefault(),a("");try{t(!0);const N=await w.login(x);g(N),setTimeout(i?()=>{d("/panier/delivery")}:()=>{d("/")},2e3)}catch(N){((h=N.response)==null?void 0:h.status)===401?a("Email ou mot de passe incorrect."):((v=N.response)==null?void 0:v.status)===400?a("Veuillez vérifier vos informations de connexion."):a(((k=(l=N.response)==null?void 0:l.data)==null?void 0:k.message)||"Une erreur est survenue lors de la connexion.")}finally{t(!1)}};return e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[u&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm",children:u}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Adresse email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(E,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",name:"email",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"votreemail@exemple.com",value:x.email,onChange:p,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Mot de passe",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(W,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"password",name:"password",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"********",value:x.password,onChange:p,required:!0})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:j,className:"text-sm text-[#007FFF] hover:underline",children:"Mot de passe oublié ?"})}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{type:"submit",className:"w-full px-4 py-3 bg-gradient-to-r from-[#7CB9E8] to-[#007FFF] text-white rounded-lg hover:from-[#6ba9d8] hover:to-[#0065cc]",disabled:m,children:m?"Chargement...":"Se connecter"})}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Ou"})})]}),e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsx("div",{className:"w-full max-w-full",children:e.jsx(_,{width:"100%",size:"large",text:"continue_with",shape:"rectangular",onSuccess:f,onError:o,useOneTap:!1})})})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Vous n'avez pas de compte ?"," ",e.jsx("button",{type:"button",onClick:b,className:"text-[#007FFF] hover:underline font-medium",children:"Créer un compte"})]})})]})},ee=({inCart:i=!1,onSwitchForm:b,onGoogleSuccess:j,onGoogleError:f})=>{const o=S(),{login:d}=C(),[g,m]=r.useState(!1),[t,u]=r.useState(""),[a,x]=r.useState({firstName:"",lastName:"",email:"",password:"",companyName:"",siretNumber:"",phoneNumber:""}),s=c=>{const{name:n,value:h}=c.target;x({...a,[n]:h})},p=async c=>{c.preventDefault();try{m(!0);const n=await w.register(a);d(n),i?setTimeout(()=>{o("/panier/delivery")},2e3):setTimeout(()=>{o("/inscription-reussie")},1e3)}catch(n){u(n.message||"Une erreur est survenue lors de l'inscription")}finally{m(!1)}};return e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[t&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm",children:t}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Prénom",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(X,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"firstName",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"Jean",value:a.firstName,onChange:s,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(X,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"lastName",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"Dupont",value:a.lastName,onChange:s,required:!0})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Adresse email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(E,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",name:"email",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"votreemail@exemple.com",value:a.email,onChange:s,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Mot de passe",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(W,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"password",name:"password",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"********",value:a.password,onChange:s,required:!0,minLength:8})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Le mot de passe doit contenir au moins 8 caractères."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Téléphone",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx($,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"tel",name:"phoneNumber",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"06 12 34 56 78",value:a.phoneNumber,onChange:s,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom de l'entreprise",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(J,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"companyName",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"Votre entreprise",value:a.companyName,onChange:s,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Numéro SIRET",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(H,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"siretNumber",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"123 456 789 00012",value:a.siretNumber,onChange:s,required:!0})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{type:"submit",className:"w-full px-4 py-3 bg-gradient-to-r from-[#7CB9E8] to-[#007FFF] text-white rounded-lg hover:from-[#6ba9d8] hover:to-[#0065cc]",disabled:g,children:g?"Chargement...":"Créer un compte"})}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Ou"})})]}),e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsx("div",{className:"w-full max-w-full",children:e.jsx(_,{width:"100%",size:"large",text:"signup_with",shape:"rectangular",onSuccess:j,onError:f,useOneTap:!1})})})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Vous avez déjà un compte ?"," ",e.jsx("button",{type:"button",onClick:b,className:"text-[#007FFF] hover:underline font-medium",children:"Se connecter"})]})})]})},M=({onCancel:i})=>{const[b,j]=r.useState(!1),[f,o]=r.useState(""),[d,g]=r.useState(""),[m,t]=r.useState({email:""}),u=s=>{s.target===s.currentTarget&&i()},a=s=>{const{name:p,value:c}=s.target;t({...m,[p]:c})},x=async s=>{var p,c,n,h,v;s.preventDefault(),o(""),g("");try{if(j(!0),!m.email){o("Veuillez renseigner votre adresse email.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(m.email)){o("Veuillez saisir une adresse email valide.");return}await w.forgotPassword(m),g("Un email de réinitialisation a été envoyé à votre adresse. Veuillez vérifier votre boîte de réception et vos spams. Le lien est valable pendant 1 heure."),t({email:""})}catch(l){((p=l.response)==null?void 0:p.status)===404?o("Aucun compte n'est associé à cette adresse email. Veuillez vérifier votre saisie ou créer un compte."):((c=l.response)==null?void 0:c.status)===400?o("Veuillez vérifier votre adresse email."):((n=l.response)==null?void 0:n.status)===429?o("Trop de tentatives. Veuillez patienter quelques minutes avant de réessayer."):o(((v=(h=l.response)==null?void 0:h.data)==null?void 0:v.message)||"Une erreur est survenue. Veuillez réessayer plus tard.")}finally{j(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",onClick:u,children:e.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-md mx-4 w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-teal-600",children:"Mot de passe oublié"}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Veuillez saisir votre adresse email. Vous recevrez un lien pour créer un nouveau mot de passe. Ce lien sera valable pendant 24 heure."}),f&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm mb-4",children:f}),d&&e.jsx("div",{className:"p-3 bg-green-100 border border-green-200 rounded-md text-green-600 text-sm mb-4",children:d}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Adresse email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(E,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",name:"email",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"votreemail@exemple.com",value:m.email,onChange:a,required:!0})]})]}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx("button",{type:"button",onClick:i,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Annuler"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-[#7CB9E8] to-[#007FFF] text-white rounded-lg hover:from-[#6BA8D7] hover:to-[#0066CC]",disabled:b,children:b?"Chargement...":"Envoyer"})]})]})]})})},O=({googleCredential:i,onCancel:b,inCart:j=!1})=>{const f=S(),{login:o}=C(),[d,g]=r.useState(!1),[m,t]=r.useState(""),[u,a]=r.useState({phoneNumber:"",companyName:"",siretNumber:""}),x=async s=>{var p,c,n,h,v;s.preventDefault(),t("");try{if(g(!0),!i)throw new Error("Session Google expirée. Veuillez réessayer.");const l=await w.registerWithGoogle(i,u);o(l),j?setTimeout(()=>{f("/panier/delivery")},2e3):setTimeout(()=>{f("/inscription-reussie")},1e3)}catch(l){console.error("Erreur d'inscription Google:",l),(n=(c=(p=l.response)==null?void 0:p.data)==null?void 0:c.message)!=null&&n.includes("téléphone")?t("Le format du numéro de téléphone n'est pas valide. Utilisez le format +33XXXXXXXXX."):t(((v=(h=l.response)==null?void 0:h.data)==null?void 0:v.message)||"Une erreur est survenue lors de l'inscription.")}finally{g(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-md mx-4 w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-teal-600",children:"Informations supplémentaires requises"}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Pour finaliser votre inscription, veuillez fournir les informations suivantes :"}),m&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm mb-4",children:m}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Numéro de téléphone",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx($,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"tel",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"06 12 34 56 78",value:u.phoneNumber,onChange:s=>a({...u,phoneNumber:s.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom de l'entreprise",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(J,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"Distritherm Services",value:u.companyName,onChange:s=>a({...u,companyName:s.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Numéro SIRET",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(H,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"123 456 789 00012",value:u.siretNumber,onChange:s=>a({...u,siretNumber:s.target.value}),required:!0})]})]}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx("button",{type:"button",onClick:b,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Annuler"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-[#7CB9E8] to-[#007FFF] text-white rounded-lg hover:from-[#6BA8D7] hover:to-[#0066CC]",disabled:d,children:d?"Chargement...":"S'inscrire"})]})]})]})})},te=({inCart:i=!1})=>{const b=S(),{isAuthenticated:j,error:f,clearError:o}=C(),[d,g]=r.useState(!0),[m,t]=r.useState(""),[u,a]=r.useState(null),[x,s]=r.useState(null),[p,c]=r.useState(!1),[n,h]=r.useState(!1),[v,l]=r.useState(!1),[k,N]=r.useState(null),[L,K]=r.useState("");r.useEffect(()=>{j&&b("/")},[j,b]),r.useEffect(()=>{f&&(t(f),o())},[f,o]),r.useEffect(()=>{const y=new URLSearchParams(window.location.search).get("token");y&&(K(y),l(!0),window.history.replaceState({},document.title,window.location.pathname))},[]);const z=async F=>{var y,V,I;try{if(t(""),!F.credential)throw new Error("Aucun credential Google reçu");s(F.credential),await w.loginWithGoogle(F.credential)}catch(U){((y=U.response)==null?void 0:y.status)===404?c(!0):t(((I=(V=U.response)==null?void 0:V.data)==null?void 0:I.message)||"Une erreur est survenue lors de la connexion avec Google.")}},P=()=>{t("La connexion avec Google a échoué. Veuillez réessayer ou utiliser le formulaire de connexion classique.")},R=()=>{g(!d),t("")},Q=()=>{h(!0),t("")},q=()=>{h(!1),t("")},A=()=>{l(!1),g(!0)},D=()=>{l(!1),g(!0)},G=()=>{c(!1),s(null),t("")},T=()=>e.jsx("section",{className:`relative ${i?"py-4":"py-20"} overflow-hidden`,children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"max-w-xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:d?"Connexion":"Inscription"}),e.jsx("p",{className:"text-gray-600",children:d?"Connectez-vous à votre compte pour continuer":"Créez un compte pour accéder à tous nos services"})]}),d?e.jsx(Z,{inCart:i,onSwitchForm:R,onShowForgotPassword:Q,onGoogleSuccess:z,onGoogleError:P}):e.jsx(ee,{inCart:i,onSwitchForm:R,onGoogleSuccess:z,onGoogleError:P})]})})})});return i?e.jsxs(e.Fragment,{children:[p&&x&&e.jsx(O,{googleCredential:x,onCancel:G,inCart:i}),n&&e.jsx(M,{onCancel:q}),v&&e.jsx(B,{token:L,onCancel:D,onSuccess:A}),T()]}):e.jsxs(Y,{children:[p&&x&&e.jsx(O,{googleCredential:x,onCancel:G,inCart:i}),n&&e.jsx(M,{onCancel:q}),v&&e.jsx(B,{token:L,onCancel:D,onSuccess:A}),T()]})};export{te as default};
