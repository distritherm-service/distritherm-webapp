import{B as z,a3 as E,r,j as e,z as R,a2 as k,a4 as U,a5 as C,a6 as G,y as I,x as T,a7 as M}from"./index-2311aXp4.js";import{L as Z}from"./Layout-BbxObWX1.js";import"./Breadcrumb-tP_Dv3le.js";const H=({inCart:j=!1,onSwitchForm:N,onShowForgotPassword:y,onGoogleSuccess:v,onGoogleError:d})=>{const p=z(),{login:l}=E(),[g,a]=r.useState(!1),[s,n]=r.useState(""),[h,t]=r.useState({email:"",password:""}),f=o=>{const{name:i,value:b}=o.target;t({...h,[i]:b})},m=async o=>{var i,b,c,x;o.preventDefault(),n("");try{a(!0);const u=await C.login(h);l(u),setTimeout(j?()=>{p("/panier/delivery")}:()=>{p("/")},2e3)}catch(u){console.error("Erreur de connexion:",u),((i=u.response)==null?void 0:i.status)===401?n("Email ou mot de passe incorrect."):((b=u.response)==null?void 0:b.status)===400?n("Veuillez vérifier vos informations de connexion."):n(((x=(c=u.response)==null?void 0:c.data)==null?void 0:x.message)||"Une erreur est survenue lors de la connexion.")}finally{a(!1)}};return e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[s&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm",children:s}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Adresse email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(R,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",name:"email",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"votreemail@exemple.com",value:h.email,onChange:f,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Mot de passe",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(k,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"password",name:"password",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"********",value:h.password,onChange:f,required:!0})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:y,className:"text-sm text-teal-600 hover:underline",children:"Mot de passe oublié ?"})}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{type:"submit",className:"w-full px-4 py-3 bg-gradient-to-r from-teal-600 to-blue-600 text-white rounded-lg hover:from-teal-700 hover:to-blue-700",disabled:g,children:g?"Chargement...":"Se connecter"})}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Ou"})})]}),e.jsx("div",{className:"mt-6",children:e.jsx(U,{width:"100%",size:"large",text:"continue_with",shape:"rectangular",onSuccess:v,onError:d})})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Vous n'avez pas de compte ?"," ",e.jsx("button",{type:"button",onClick:N,className:"text-teal-600 hover:underline font-medium",children:"Créer un compte"})]})})]})},K=({inCart:j=!1,onSwitchForm:N,onGoogleSuccess:y,onGoogleError:v})=>{const d=z(),{login:p}=E(),[l,g]=r.useState(!1),[a,s]=r.useState(""),[n,h]=r.useState({firstName:"",lastName:"",email:"",password:"",companyName:"",siretNumber:"",phoneNumber:""}),t=m=>{const{name:o,value:i}=m.target;h({...n,[o]:i})},f=async m=>{var o,i,b,c,x,u,S;m.preventDefault(),s("");try{g(!0),console.log("Données d'inscription à envoyer:",n);const w=await C.register(n);p(w),j?setTimeout(()=>{d("/panier/delivery")},2e3):setTimeout(()=>{d("/inscription-reussie")},1e3)}catch(w){console.error("Erreur d'inscription:",w),((o=w.response)==null?void 0:o.status)===409?s("Un utilisateur avec cette adresse email existe déjà."):((i=w.response)==null?void 0:i.status)===400?(x=(c=(b=w.response)==null?void 0:b.data)==null?void 0:c.message)!=null&&x.includes("téléphone")?s("Le format du numéro de téléphone n'est pas valide. Utilisez le format +33XXXXXXXXX."):s("Veuillez vérifier vos informations d'inscription."):s(((S=(u=w.response)==null?void 0:u.data)==null?void 0:S.message)||"Une erreur est survenue lors de l'inscription.")}finally{g(!1)}};return e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[a&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm",children:a}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Prénom",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(G,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"firstName",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"Jean",value:n.firstName,onChange:t,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(G,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"lastName",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"Dupont",value:n.lastName,onChange:t,required:!0})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Adresse email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(R,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",name:"email",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"votreemail@exemple.com",value:n.email,onChange:t,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Mot de passe",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(k,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"password",name:"password",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"********",value:n.password,onChange:t,required:!0,minLength:8})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Le mot de passe doit contenir au moins 8 caractères."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Téléphone",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(I,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"tel",name:"phoneNumber",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"06 12 34 56 78",value:n.phoneNumber,onChange:t,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom de l'entreprise",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(T,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"companyName",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"Votre entreprise",value:n.companyName,onChange:t,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Numéro SIRET",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(M,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"siretNumber",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"123 456 789 00012",value:n.siretNumber,onChange:t,required:!0})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{type:"submit",className:"w-full px-4 py-3 bg-gradient-to-r from-teal-600 to-blue-600 text-white rounded-lg hover:from-teal-700 hover:to-blue-700",disabled:l,children:l?"Chargement...":"Créer un compte"})}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Ou"})})]}),e.jsx("div",{className:"mt-6",children:e.jsx(U,{width:"100%",size:"large",text:"signup_with",shape:"rectangular",onSuccess:y,onError:v})})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Vous avez déjà un compte ?"," ",e.jsx("button",{type:"button",onClick:N,className:"text-teal-600 hover:underline font-medium",children:"Se connecter"})]})})]})},Q=({onCancel:j})=>{const[N,y]=r.useState(!1),[v,d]=r.useState(""),[p,l]=r.useState(""),[g,a]=r.useState({email:""}),s=h=>{const{name:t,value:f}=h.target;a({...g,[t]:f})},n=async h=>{var t,f,m,o,i,b,c;h.preventDefault(),d(""),l("");try{if(y(!0),!g.email){d("Veuillez renseigner votre adresse email.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g.email)){d("Veuillez saisir une adresse email valide.");return}await C.forgotPassword(g),l("Un email de réinitialisation a été envoyé à votre adresse. Veuillez vérifier votre boîte de réception et vos spams. Le lien est valable pendant 1 heure."),a({email:""})}catch(x){console.error("Erreur détaillée:",{message:x.message,response:x.response,status:(t=x.response)==null?void 0:t.status,data:(f=x.response)==null?void 0:f.data}),((m=x.response)==null?void 0:m.status)===404?d("Aucun compte n'est associé à cette adresse email. Veuillez vérifier votre saisie ou créer un compte."):((o=x.response)==null?void 0:o.status)===400?d("Veuillez vérifier votre adresse email."):((i=x.response)==null?void 0:i.status)===429?d("Trop de tentatives. Veuillez patienter quelques minutes avant de réessayer."):d(((c=(b=x.response)==null?void 0:b.data)==null?void 0:c.message)||"Une erreur est survenue. Veuillez réessayer plus tard.")}finally{y(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-md mx-4 w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-teal-600",children:"Mot de passe oublié"}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Veuillez saisir votre adresse email. Vous recevrez un lien pour créer un nouveau mot de passe. Ce lien sera valable pendant 1 heure."}),v&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm mb-4",children:v}),p&&e.jsx("div",{className:"p-3 bg-green-100 border border-green-200 rounded-md text-green-600 text-sm mb-4",children:p}),e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Adresse email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(R,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",name:"email",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"votreemail@exemple.com",value:g.email,onChange:s,required:!0})]})]}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx("button",{type:"button",onClick:j,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Annuler"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-teal-600 to-blue-600 text-white rounded-lg hover:from-teal-700 hover:to-blue-700",disabled:N,children:N?"Chargement...":"Envoyer"})]})]})]})})},Y=({token:j,onCancel:N,onSuccess:y})=>{const[v,d]=r.useState(!1),[p,l]=r.useState(""),[g,a]=r.useState(""),[s,n]=r.useState({password:"",confirmPassword:"",token:j}),h=f=>{const{name:m,value:o}=f.target;n({...s,[m]:o})},t=async f=>{var m,o,i,b,c,x;f.preventDefault(),l(""),a("");try{if(d(!0),!s.token){l("Le lien de réinitialisation est invalide. Veuillez utiliser le lien envoyé par email.");return}if(s.password!==s.confirmPassword){l("Les mots de passe ne correspondent pas.");return}if(s.password.length<8){l("Le mot de passe doit contenir au moins 8 caractères.");return}const u=/[A-Z]/.test(s.password),S=/\d/.test(s.password);if(!u||!S){l("Le mot de passe doit contenir au moins une majuscule et un chiffre.");return}await C.resetPassword({password:s.password,token:s.token}),a("Votre mot de passe a été réinitialisé avec succès. Vous allez être redirigé vers la page de connexion."),setTimeout(()=>{y()},2e3)}catch(u){console.error("Erreur détaillée:",{message:u.message,response:u.response,status:(m=u.response)==null?void 0:m.status,data:(o=u.response)==null?void 0:o.data}),((i=u.response)==null?void 0:i.status)===400?l("Le lien de réinitialisation est invalide ou a expiré. Veuillez faire une nouvelle demande."):((b=u.response)==null?void 0:b.status)===401?l("Le lien de réinitialisation a expiré. Veuillez faire une nouvelle demande."):l(((x=(c=u.response)==null?void 0:c.data)==null?void 0:x.message)||"Une erreur est survenue. Veuillez réessayer plus tard.")}finally{d(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-md mx-4 w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-teal-600",children:"Réinitialisation du mot de passe"}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Veuillez saisir votre nouveau mot de passe."}),p&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm mb-4",children:p}),g&&e.jsx("div",{className:"p-3 bg-green-100 border border-green-200 rounded-md text-green-600 text-sm mb-4",children:g}),e.jsxs("form",{onSubmit:t,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nouveau mot de passe",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(k,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"password",name:"password",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"********",value:s.password,onChange:h,required:!0,minLength:8})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Le mot de passe doit contenir au moins 8 caractères, une majuscule et un chiffre."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Confirmer le mot de passe",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(k,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"password",name:"confirmPassword",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"********",value:s.confirmPassword,onChange:h,required:!0})]})]}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx("button",{type:"button",onClick:N,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Annuler"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-teal-600 to-blue-600 text-white rounded-lg hover:from-teal-700 hover:to-blue-700",disabled:v,children:v?"Chargement...":"Réinitialiser"})]})]})]})})},ee=({googleCredential:j,onCancel:N,inCart:y=!1})=>{const v=z(),{login:d}=E(),[p,l]=r.useState(!1),[g,a]=r.useState(""),[s,n]=r.useState({phoneNumber:"",companyName:"",siretNumber:""}),h=async t=>{var f,m,o,i,b;t.preventDefault(),a("");try{if(l(!0),!j)throw new Error("Session Google expirée. Veuillez réessayer.");const c=await C.registerWithGoogle(j,s);d(c),y?setTimeout(()=>{v("/panier/delivery")},2e3):setTimeout(()=>{v("/inscription-reussie")},1e3)}catch(c){console.error("Erreur d'inscription Google:",c),(o=(m=(f=c.response)==null?void 0:f.data)==null?void 0:m.message)!=null&&o.includes("téléphone")?a("Le format du numéro de téléphone n'est pas valide. Utilisez le format +33XXXXXXXXX."):a(((b=(i=c.response)==null?void 0:i.data)==null?void 0:b.message)||"Une erreur est survenue lors de l'inscription.")}finally{l(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-md mx-4 w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-teal-600",children:"Informations supplémentaires requises"}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Pour finaliser votre inscription, veuillez fournir les informations suivantes :"}),g&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm mb-4",children:g}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Numéro de téléphone",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(I,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"tel",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"06 12 34 56 78",value:s.phoneNumber,onChange:t=>n({...s,phoneNumber:t.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom de l'entreprise",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(T,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"Distritherm Services",value:s.companyName,onChange:t=>n({...s,companyName:t.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Numéro SIRET",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(M,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"123 456 789 00012",value:s.siretNumber,onChange:t=>n({...s,siretNumber:t.target.value}),required:!0})]})]}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx("button",{type:"button",onClick:N,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Annuler"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-teal-600 to-blue-600 text-white rounded-lg hover:from-teal-700 hover:to-blue-700",disabled:p,children:p?"Chargement...":"S'inscrire"})]})]})]})})},ae=({inCart:j=!1})=>{const N=z(),{isAuthenticated:y,error:v,clearError:d}=E(),[p,l]=r.useState(!0),[g,a]=r.useState(""),[s,n]=r.useState(null),[h,t]=r.useState(null),[f,m]=r.useState(!1),[o,i]=r.useState(!1),[b,c]=r.useState(!1),[x,u]=r.useState(null),[S,w]=r.useState("");r.useEffect(()=>{y&&N("/")},[y,N]),r.useEffect(()=>{v&&(a(v),d())},[v,d]),r.useEffect(()=>{const F=new URLSearchParams(window.location.search).get("token");F&&(w(F),c(!0),window.history.replaceState({},document.title,window.location.pathname))},[]);const V=async L=>{var F,X,A;try{if(a(""),!L.credential)throw new Error("Aucun credential Google reçu");t(L.credential),await C.loginWithGoogle(L.credential)}catch(P){console.error("Erreur Google Login:",P),((F=P.response)==null?void 0:F.status)===404?m(!0):a(((A=(X=P.response)==null?void 0:X.data)==null?void 0:A.message)||"Une erreur est survenue lors de la connexion avec Google.")}},q=()=>{a("La connexion avec Google a échoué. Veuillez réessayer ou utiliser le formulaire de connexion classique.")},D=()=>{l(!p),a("")},B=()=>{i(!0),a("")},O=()=>{i(!1),a("")},W=()=>{c(!1),l(!0)},_=()=>{c(!1),l(!0)},$=()=>{m(!1),t(null),a("")},J=()=>e.jsx("section",{className:`relative ${j?"py-4":"py-20"} overflow-hidden`,children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"max-w-xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:p?"Connexion":"Inscription"}),e.jsx("p",{className:"text-gray-600",children:p?"Connectez-vous à votre compte pour continuer":"Créez un compte pour accéder à tous nos services"})]}),p?e.jsx(H,{inCart:j,onSwitchForm:D,onShowForgotPassword:B,onGoogleSuccess:V,onGoogleError:q}):e.jsx(K,{inCart:j,onSwitchForm:D,onGoogleSuccess:V,onGoogleError:q})]})})})});return e.jsxs(Z,{children:[f&&h&&e.jsx(ee,{googleCredential:h,onCancel:$,inCart:j}),o&&e.jsx(Q,{onCancel:O}),b&&e.jsx(Y,{token:S,onCancel:_,onSuccess:W}),J()]})};export{ae as default};
