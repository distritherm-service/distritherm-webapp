import{u as S,a9 as C,r,j as e,K as k,a8 as D,aa as V,ab as w,ac as A,J as I,I as T,ad as U,ae as K}from"./index-CDkvhUR-.js";import{L as H}from"./Layout-Cl8seCFz.js";import"./Slider-0voPl_dV.js";const Q=({inCart:g=!1,onSwitchForm:v,onShowForgotPassword:j,onGoogleSuccess:f,onGoogleError:n})=>{const o=S(),{login:x}=C(),[i,t]=r.useState(!1),[c,a]=r.useState(""),[d,s]=r.useState({email:"",password:""}),p=l=>{const{name:m,value:u}=l.target;s({...d,[m]:u})},h=async l=>{var m,u,b,E;l.preventDefault(),a("");try{t(!0);const N=await w.login(d);x(N),setTimeout(g?()=>{o("/panier/delivery")}:()=>{o("/")},2e3)}catch(N){((m=N.response)==null?void 0:m.status)===401?a("Email ou mot de passe incorrect."):((u=N.response)==null?void 0:u.status)===400?a("Veuillez vérifier vos informations de connexion."):a(((E=(b=N.response)==null?void 0:b.data)==null?void 0:E.message)||"Une erreur est survenue lors de la connexion.")}finally{t(!1)}};return e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[c&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm",children:c}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Adresse email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(k,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",name:"email",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"votreemail@exemple.com",value:d.email,onChange:p,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Mot de passe",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(D,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"password",name:"password",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"********",value:d.password,onChange:p,required:!0})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:j,className:"text-sm text-[#007FFF] hover:underline",children:"Mot de passe oublié ?"})}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{type:"submit",className:"w-full px-4 py-3 bg-gradient-to-r from-[#7CB9E8] to-[#007FFF] text-white rounded-lg hover:from-[#6ba9d8] hover:to-[#0065cc]",disabled:i,children:i?"Chargement...":"Se connecter"})}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Ou"})})]}),e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsx("div",{className:"w-full max-w-full",children:e.jsx(V,{width:"100%",size:"large",text:"continue_with",shape:"rectangular",onSuccess:f,onError:n,useOneTap:!1})})})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Vous n'avez pas de compte ?"," ",e.jsx("button",{type:"button",onClick:v,className:"text-[#007FFF] hover:underline font-medium",children:"Créer un compte"})]})})]})},Y=({inCart:g=!1,onSwitchForm:v,onGoogleSuccess:j,onGoogleError:f})=>{const n=S(),{login:o}=C(),[x,i]=r.useState(!1),[t,c]=r.useState(""),[a,d]=r.useState({firstName:"",lastName:"",email:"",password:"",companyName:"",siretNumber:"",phoneNumber:""}),s=h=>{const{name:l,value:m}=h.target;d({...a,[l]:m})},p=async h=>{h.preventDefault();try{i(!0);const l=await w.register(a);o(l),g?setTimeout(()=>{n("/panier/delivery")},2e3):setTimeout(()=>{n("/inscription-reussie")},1e3)}catch(l){c(l.message||"Une erreur est survenue lors de l'inscription")}finally{i(!1)}};return e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[t&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm",children:t}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Prénom",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(A,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"firstName",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"Jean",value:a.firstName,onChange:s,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(A,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"lastName",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"Dupont",value:a.lastName,onChange:s,required:!0})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Adresse email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(k,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",name:"email",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"votreemail@exemple.com",value:a.email,onChange:s,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Mot de passe",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(D,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"password",name:"password",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"********",value:a.password,onChange:s,required:!0,minLength:8})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Le mot de passe doit contenir au moins 8 caractères."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Téléphone",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(I,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"tel",name:"phoneNumber",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"06 12 34 56 78",value:a.phoneNumber,onChange:s,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom de l'entreprise",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(T,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"companyName",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"Votre entreprise",value:a.companyName,onChange:s,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Numéro SIRET",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(U,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"siretNumber",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"123 456 789 00012",value:a.siretNumber,onChange:s,required:!0})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{type:"submit",className:"w-full px-4 py-3 bg-gradient-to-r from-[#7CB9E8] to-[#007FFF] text-white rounded-lg hover:from-[#6ba9d8] hover:to-[#0065cc]",disabled:x,children:x?"Chargement...":"Créer un compte"})}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Ou"})})]}),e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsx("div",{className:"w-full max-w-full",children:e.jsx(V,{width:"100%",size:"large",text:"signup_with",shape:"rectangular",onSuccess:j,onError:f,useOneTap:!1})})})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Vous avez déjà un compte ?"," ",e.jsx("button",{type:"button",onClick:v,className:"text-[#007FFF] hover:underline font-medium",children:"Se connecter"})]})})]})},Z=({onCancel:g})=>{const[v,j]=r.useState(!1),[f,n]=r.useState(""),[o,x]=r.useState(""),[i,t]=r.useState({email:""}),c=d=>{const{name:s,value:p}=d.target;t({...i,[s]:p})},a=async d=>{var s,p,h,l,m;d.preventDefault(),n(""),x("");try{if(j(!0),!i.email){n("Veuillez renseigner votre adresse email.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.email)){n("Veuillez saisir une adresse email valide.");return}await w.forgotPassword(i),x("Un email de réinitialisation a été envoyé à votre adresse. Veuillez vérifier votre boîte de réception et vos spams. Le lien est valable pendant 1 heure."),t({email:""})}catch(u){((s=u.response)==null?void 0:s.status)===404?n("Aucun compte n'est associé à cette adresse email. Veuillez vérifier votre saisie ou créer un compte."):((p=u.response)==null?void 0:p.status)===400?n("Veuillez vérifier votre adresse email."):((h=u.response)==null?void 0:h.status)===429?n("Trop de tentatives. Veuillez patienter quelques minutes avant de réessayer."):n(((m=(l=u.response)==null?void 0:l.data)==null?void 0:m.message)||"Une erreur est survenue. Veuillez réessayer plus tard.")}finally{j(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-md mx-4 w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-teal-600",children:"Mot de passe oublié"}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Veuillez saisir votre adresse email. Vous recevrez un lien pour créer un nouveau mot de passe. Ce lien sera valable pendant 24 heure."}),f&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm mb-4",children:f}),o&&e.jsx("div",{className:"p-3 bg-green-100 border border-green-200 rounded-md text-green-600 text-sm mb-4",children:o}),e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Adresse email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(k,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",name:"email",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"votreemail@exemple.com",value:i.email,onChange:c,required:!0})]})]}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx("button",{type:"button",onClick:g,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Annuler"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-teal-600 to-blue-600 text-white rounded-lg hover:from-teal-700 hover:to-blue-700",disabled:v,children:v?"Chargement...":"Envoyer"})]})]})]})})},ee=({googleCredential:g,onCancel:v,inCart:j=!1})=>{const f=S(),{login:n}=C(),[o,x]=r.useState(!1),[i,t]=r.useState(""),[c,a]=r.useState({phoneNumber:"",companyName:"",siretNumber:""}),d=async s=>{var p,h,l,m,u;s.preventDefault(),t("");try{if(x(!0),!g)throw new Error("Session Google expirée. Veuillez réessayer.");const b=await w.registerWithGoogle(g,c);n(b),j?setTimeout(()=>{f("/panier/delivery")},2e3):setTimeout(()=>{f("/inscription-reussie")},1e3)}catch(b){console.error("Erreur d'inscription Google:",b),(l=(h=(p=b.response)==null?void 0:p.data)==null?void 0:h.message)!=null&&l.includes("téléphone")?t("Le format du numéro de téléphone n'est pas valide. Utilisez le format +33XXXXXXXXX."):t(((u=(m=b.response)==null?void 0:m.data)==null?void 0:u.message)||"Une erreur est survenue lors de l'inscription.")}finally{x(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-md mx-4 w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-teal-600",children:"Informations supplémentaires requises"}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Pour finaliser votre inscription, veuillez fournir les informations suivantes :"}),i&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm mb-4",children:i}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Numéro de téléphone",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(I,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"tel",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"06 12 34 56 78",value:c.phoneNumber,onChange:s=>a({...c,phoneNumber:s.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom de l'entreprise",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(T,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"Distritherm Services",value:c.companyName,onChange:s=>a({...c,companyName:s.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Numéro SIRET",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(U,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"123 456 789 00012",value:c.siretNumber,onChange:s=>a({...c,siretNumber:s.target.value}),required:!0})]})]}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx("button",{type:"button",onClick:v,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Annuler"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-teal-600 to-blue-600 text-white rounded-lg hover:from-teal-700 hover:to-blue-700",disabled:o,children:o?"Chargement...":"S'inscrire"})]})]})]})})},ae=({inCart:g=!1})=>{const v=S(),{isAuthenticated:j,error:f,clearError:n}=C(),[o,x]=r.useState(!0),[i,t]=r.useState(""),[c,a]=r.useState(null),[d,s]=r.useState(null),[p,h]=r.useState(!1),[l,m]=r.useState(!1),[u,b]=r.useState(!1),[E,N]=r.useState(null),[X,M]=r.useState("");r.useEffect(()=>{j&&v("/")},[j,v]),r.useEffect(()=>{f&&(t(f),n())},[f,n]),r.useEffect(()=>{const y=new URLSearchParams(window.location.search).get("token");y&&(M(y),b(!0),window.history.replaceState({},document.title,window.location.pathname))},[]);const L=async F=>{var y,R,q;try{if(t(""),!F.credential)throw new Error("Aucun credential Google reçu");s(F.credential),await w.loginWithGoogle(F.credential)}catch(G){((y=G.response)==null?void 0:y.status)===404?h(!0):t(((q=(R=G.response)==null?void 0:R.data)==null?void 0:q.message)||"Une erreur est survenue lors de la connexion avec Google.")}},z=()=>{t("La connexion avec Google a échoué. Veuillez réessayer ou utiliser le formulaire de connexion classique.")},P=()=>{x(!o),t("")},O=()=>{m(!0),t("")},B=()=>{m(!1),t("")},J=()=>{b(!1),x(!0)},W=()=>{b(!1),x(!0)},_=()=>{h(!1),s(null),t("")},$=()=>e.jsx("section",{className:`relative ${g?"py-4":"py-20"} overflow-hidden`,children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"max-w-xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:o?"Connexion":"Inscription"}),e.jsx("p",{className:"text-gray-600",children:o?"Connectez-vous à votre compte pour continuer":"Créez un compte pour accéder à tous nos services"})]}),o?e.jsx(Q,{inCart:g,onSwitchForm:P,onShowForgotPassword:O,onGoogleSuccess:L,onGoogleError:z}):e.jsx(Y,{inCart:g,onSwitchForm:P,onGoogleSuccess:L,onGoogleError:z})]})})})});return e.jsxs(H,{children:[p&&d&&e.jsx(ee,{googleCredential:d,onCancel:_,inCart:g}),l&&e.jsx(Z,{onCancel:B}),u&&e.jsx(K,{token:X,onCancel:W,onSuccess:J}),$()]})};export{ae as default};
