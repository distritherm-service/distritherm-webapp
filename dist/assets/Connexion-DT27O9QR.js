import{u as S,a7 as C,r,j as e,H as k,a6 as G,a8 as T,a9 as w,aa as A,E as V,D as I,ab as U,ac as J}from"./index-CLCNF0y8.js";import{L as K}from"./Layout-BpCCD0Pq.js";const Q=({inCart:x=!1,onSwitchForm:b,onShowForgotPassword:j,onGoogleSuccess:g,onGoogleError:l})=>{const c=S(),{login:p}=C(),[d,t]=r.useState(!1),[m,a]=r.useState(""),[f,s]=r.useState({email:"",password:""}),h=o=>{const{name:u,value:v}=o.target;s({...f,[u]:v})},i=async o=>{var u,v,n,E;o.preventDefault(),a("");try{t(!0);const N=await w.login(f);p(N),setTimeout(x?()=>{c("/panier/delivery")}:()=>{c("/")},2e3)}catch(N){((u=N.response)==null?void 0:u.status)===401?a("Email ou mot de passe incorrect."):((v=N.response)==null?void 0:v.status)===400?a("Veuillez vérifier vos informations de connexion."):a(((E=(n=N.response)==null?void 0:n.data)==null?void 0:E.message)||"Une erreur est survenue lors de la connexion.")}finally{t(!1)}};return e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[m&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm",children:m}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Adresse email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(k,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",name:"email",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"votreemail@exemple.com",value:f.email,onChange:h,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Mot de passe",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(G,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"password",name:"password",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"********",value:f.password,onChange:h,required:!0})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:j,className:"text-sm text-[#007FFF] hover:underline",children:"Mot de passe oublié ?"})}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{type:"submit",className:"w-full px-4 py-3 bg-gradient-to-r from-[#7CB9E8] to-[#007FFF] text-white rounded-lg hover:from-[#6ba9d8] hover:to-[#0065cc]",disabled:d,children:d?"Chargement...":"Se connecter"})}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Ou"})})]}),e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsx("div",{className:"w-full max-w-full",children:e.jsx(T,{width:"100%",size:"large",text:"continue_with",shape:"rectangular",onSuccess:g,onError:l,useOneTap:!1})})})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Vous n'avez pas de compte ?"," ",e.jsx("button",{type:"button",onClick:b,className:"text-[#007FFF] hover:underline font-medium",children:"Créer un compte"})]})})]})},Y=({inCart:x=!1,onSwitchForm:b,onGoogleSuccess:j,onGoogleError:g})=>{const l=S(),{login:c}=C(),[p,d]=r.useState(!1),[t,m]=r.useState(""),[a,f]=r.useState({firstName:"",lastName:"",email:"",password:"",companyName:"",siretNumber:"",phoneNumber:""}),s=i=>{const{name:o,value:u}=i.target;f({...a,[o]:u})},h=async i=>{i.preventDefault();try{d(!0);const o=await w.register(a);c(o),x?setTimeout(()=>{l("/panier/delivery")},2e3):setTimeout(()=>{l("/inscription-reussie")},1e3)}catch(o){m(o.message||"Une erreur est survenue lors de l'inscription")}finally{d(!1)}};return e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[t&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm",children:t}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Prénom",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(A,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"firstName",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"Jean",value:a.firstName,onChange:s,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(A,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"lastName",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"Dupont",value:a.lastName,onChange:s,required:!0})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Adresse email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(k,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",name:"email",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"votreemail@exemple.com",value:a.email,onChange:s,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Mot de passe",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(G,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"password",name:"password",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"********",value:a.password,onChange:s,required:!0,minLength:8})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Le mot de passe doit contenir au moins 8 caractères."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Téléphone",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(V,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"tel",name:"phoneNumber",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"06 12 34 56 78",value:a.phoneNumber,onChange:s,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom de l'entreprise",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(I,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"companyName",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"Votre entreprise",value:a.companyName,onChange:s,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Numéro SIRET",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(U,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"siretNumber",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"123 456 789 00012",value:a.siretNumber,onChange:s,required:!0})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{type:"submit",className:"w-full px-4 py-3 bg-gradient-to-r from-[#7CB9E8] to-[#007FFF] text-white rounded-lg hover:from-[#6ba9d8] hover:to-[#0065cc]",disabled:p,children:p?"Chargement...":"Créer un compte"})}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Ou"})})]}),e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsx("div",{className:"w-full max-w-full",children:e.jsx(T,{width:"100%",size:"large",text:"signup_with",shape:"rectangular",onSuccess:j,onError:g,useOneTap:!1})})})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Vous avez déjà un compte ?"," ",e.jsx("button",{type:"button",onClick:b,className:"text-[#007FFF] hover:underline font-medium",children:"Se connecter"})]})})]})},Z=({onCancel:x})=>{const[b,j]=r.useState(!1),[g,l]=r.useState(""),[c,p]=r.useState(""),[d,t]=r.useState({email:""}),m=s=>{s.target===s.currentTarget&&x()},a=s=>{const{name:h,value:i}=s.target;t({...d,[h]:i})},f=async s=>{var h,i,o,u,v;s.preventDefault(),l(""),p("");try{if(j(!0),!d.email){l("Veuillez renseigner votre adresse email.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)){l("Veuillez saisir une adresse email valide.");return}await w.forgotPassword(d),p("Un email de réinitialisation a été envoyé à votre adresse. Veuillez vérifier votre boîte de réception et vos spams. Le lien est valable pendant 1 heure."),t({email:""})}catch(n){((h=n.response)==null?void 0:h.status)===404?l("Aucun compte n'est associé à cette adresse email. Veuillez vérifier votre saisie ou créer un compte."):((i=n.response)==null?void 0:i.status)===400?l("Veuillez vérifier votre adresse email."):((o=n.response)==null?void 0:o.status)===429?l("Trop de tentatives. Veuillez patienter quelques minutes avant de réessayer."):l(((v=(u=n.response)==null?void 0:u.data)==null?void 0:v.message)||"Une erreur est survenue. Veuillez réessayer plus tard.")}finally{j(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",onClick:m,children:e.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-md mx-4 w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-teal-600",children:"Mot de passe oublié"}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Veuillez saisir votre adresse email. Vous recevrez un lien pour créer un nouveau mot de passe. Ce lien sera valable pendant 24 heure."}),g&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm mb-4",children:g}),c&&e.jsx("div",{className:"p-3 bg-green-100 border border-green-200 rounded-md text-green-600 text-sm mb-4",children:c}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Adresse email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(k,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",name:"email",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"votreemail@exemple.com",value:d.email,onChange:a,required:!0})]})]}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx("button",{type:"button",onClick:x,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Annuler"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-[#7CB9E8] to-[#007FFF] text-white rounded-lg hover:from-[#6BA8D7] hover:to-[#0066CC]",disabled:b,children:b?"Chargement...":"Envoyer"})]})]})]})})},ee=({googleCredential:x,onCancel:b,inCart:j=!1})=>{const g=S(),{login:l}=C(),[c,p]=r.useState(!1),[d,t]=r.useState(""),[m,a]=r.useState({phoneNumber:"",companyName:"",siretNumber:""}),f=async s=>{var h,i,o,u,v;s.preventDefault(),t("");try{if(p(!0),!x)throw new Error("Session Google expirée. Veuillez réessayer.");const n=await w.registerWithGoogle(x,m);l(n),j?setTimeout(()=>{g("/panier/delivery")},2e3):setTimeout(()=>{g("/inscription-reussie")},1e3)}catch(n){console.error("Erreur d'inscription Google:",n),(o=(i=(h=n.response)==null?void 0:h.data)==null?void 0:i.message)!=null&&o.includes("téléphone")?t("Le format du numéro de téléphone n'est pas valide. Utilisez le format +33XXXXXXXXX."):t(((v=(u=n.response)==null?void 0:u.data)==null?void 0:v.message)||"Une erreur est survenue lors de l'inscription.")}finally{p(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-md mx-4 w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-teal-600",children:"Informations supplémentaires requises"}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Pour finaliser votre inscription, veuillez fournir les informations suivantes :"}),d&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm mb-4",children:d}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Numéro de téléphone",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(V,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"tel",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"06 12 34 56 78",value:m.phoneNumber,onChange:s=>a({...m,phoneNumber:s.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom de l'entreprise",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(I,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"Distritherm Services",value:m.companyName,onChange:s=>a({...m,companyName:s.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Numéro SIRET",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(U,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"123 456 789 00012",value:m.siretNumber,onChange:s=>a({...m,siretNumber:s.target.value}),required:!0})]})]}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx("button",{type:"button",onClick:b,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Annuler"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-[#7CB9E8] to-[#007FFF] text-white rounded-lg hover:from-[#6BA8D7] hover:to-[#0066CC]",disabled:c,children:c?"Chargement...":"S'inscrire"})]})]})]})})},te=({inCart:x=!1})=>{const b=S(),{isAuthenticated:j,error:g,clearError:l}=C(),[c,p]=r.useState(!0),[d,t]=r.useState(""),[m,a]=r.useState(null),[f,s]=r.useState(null),[h,i]=r.useState(!1),[o,u]=r.useState(!1),[v,n]=r.useState(!1),[E,N]=r.useState(null),[X,B]=r.useState("");r.useEffect(()=>{j&&b("/")},[j,b]),r.useEffect(()=>{g&&(t(g),l())},[g,l]),r.useEffect(()=>{const y=new URLSearchParams(window.location.search).get("token");y&&(B(y),n(!0),window.history.replaceState({},document.title,window.location.pathname))},[]);const L=async F=>{var y,D,R;try{if(t(""),!F.credential)throw new Error("Aucun credential Google reçu");s(F.credential),await w.loginWithGoogle(F.credential)}catch(q){((y=q.response)==null?void 0:y.status)===404?i(!0):t(((R=(D=q.response)==null?void 0:D.data)==null?void 0:R.message)||"Une erreur est survenue lors de la connexion avec Google.")}},z=()=>{t("La connexion avec Google a échoué. Veuillez réessayer ou utiliser le formulaire de connexion classique.")},P=()=>{p(!c),t("")},M=()=>{u(!0),t("")},O=()=>{u(!1),t("")},W=()=>{n(!1),p(!0)},_=()=>{n(!1),p(!0)},$=()=>{i(!1),s(null),t("")},H=()=>e.jsx("section",{className:`relative ${x?"py-4":"py-20"} overflow-hidden`,children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"max-w-xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:c?"Connexion":"Inscription"}),e.jsx("p",{className:"text-gray-600",children:c?"Connectez-vous à votre compte pour continuer":"Créez un compte pour accéder à tous nos services"})]}),c?e.jsx(Q,{inCart:x,onSwitchForm:P,onShowForgotPassword:M,onGoogleSuccess:L,onGoogleError:z}):e.jsx(Y,{inCart:x,onSwitchForm:P,onGoogleSuccess:L,onGoogleError:z})]})})})});return e.jsxs(K,{children:[h&&f&&e.jsx(ee,{googleCredential:f,onCancel:$,inCart:x}),o&&e.jsx(Z,{onCancel:O}),v&&e.jsx(J,{token:X,onCancel:_,onSuccess:W}),H()]})};export{te as default};
