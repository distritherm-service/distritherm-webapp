import{u as C,a0 as k,r as t,j as e,f as L,a9 as _,aa as Z,a3 as ee,ab as $,ac as F,a4 as B,e as J,s as H,a5 as K,ad as M}from"./index-DFVFysGo.js";import{L as se}from"./Layout-CoBVPw1h.js";const te=({inCart:l=!1,onSwitchForm:p,onShowForgotPassword:b,onGoogleSuccess:v,onGoogleError:i})=>{const h=C(),{login:u}=k(),[o,x]=t.useState(!1),[r,a]=t.useState(""),[j,s]=t.useState(!1),[c,m]=t.useState({email:"",password:""}),d=f=>{const{name:n,value:N}=f.target;m({...c,[n]:N})},g=async f=>{var n,N,E,P;f.preventDefault(),a("");try{x(!0);const y=await F.login(c);u(y),l||setTimeout(()=>{h("/")},2e3)}catch(y){((n=y.response)==null?void 0:n.status)===401?a("Email ou mot de passe incorrect."):((N=y.response)==null?void 0:N.status)===400?a("Veuillez vérifier vos informations de connexion."):a(((P=(E=y.response)==null?void 0:E.data)==null?void 0:P.message)||"Une erreur est survenue lors de la connexion.")}finally{x(!1)}};return e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[r&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm",children:r}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Adresse email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(L,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",name:"email",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"votreemail@exemple.com",value:c.email,onChange:d,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Mot de passe",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(_,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:j?"text":"password",name:"password",className:"w-full pl-10 pr-12 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"********",value:c.password,onChange:d,required:!0}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>s(!j),children:j?e.jsx(Z,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):e.jsx(ee,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:b,className:"text-sm text-[#007FFF] hover:underline",children:"Mot de passe oublié ?"})}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{type:"submit",className:"w-full px-4 py-3 bg-gradient-to-r from-[#7CB9E8] to-[#007FFF] text-white rounded-lg hover:from-[#6ba9d8] hover:to-[#0065cc]",disabled:o,children:o?"Chargement...":"Se connecter"})}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Ou"})})]}),e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsx("div",{className:"w-full max-w-full",children:e.jsx($,{width:"100%",size:"large",text:"continue_with",shape:"rectangular",onSuccess:v,onError:i,useOneTap:!1})})})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Vous n'avez pas de compte ?"," ",e.jsx("button",{type:"button",onClick:p,className:"text-[#007FFF] hover:underline font-medium",children:"Créer un compte"})]})})]})},re=({inCart:l=!1,onSwitchForm:p,onGoogleSuccess:b,onGoogleError:v})=>{const i=C(),{login:h}=k(),[u,o]=t.useState(!1),[x,r]=t.useState(""),[a,j]=t.useState({firstName:"",lastName:"",email:"",password:"",companyName:"",siretNumber:"",phoneNumber:""}),s=m=>{const{name:d,value:g}=m.target;j({...a,[d]:g})},c=async m=>{m.preventDefault();try{o(!0);const d=await F.register(a);h(d),l||setTimeout(()=>{i("/inscription-reussie")},1e3)}catch(d){r(d.message||"Une erreur est survenue lors de l'inscription")}finally{o(!1)}};return e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[x&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm",children:x}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Prénom",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(B,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"firstName",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"Jean",value:a.firstName,onChange:s,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(B,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"lastName",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"Dupont",value:a.lastName,onChange:s,required:!0})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Adresse email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(L,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",name:"email",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"votreemail@exemple.com",value:a.email,onChange:s,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Mot de passe",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(_,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"password",name:"password",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"********",value:a.password,onChange:s,required:!0,minLength:8})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Le mot de passe doit contenir au moins 8 caractères."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Téléphone",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(J,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"tel",name:"phoneNumber",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"06 12 34 56 78",value:a.phoneNumber,onChange:s,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom de l'entreprise",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(H,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"companyName",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"Votre entreprise",value:a.companyName,onChange:s,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Numéro SIRET",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(K,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"siretNumber",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#007FFF] focus:border-transparent",placeholder:"123 456 789 00012",value:a.siretNumber,onChange:s,required:!0})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{type:"submit",className:"w-full px-4 py-3 bg-gradient-to-r from-[#7CB9E8] to-[#007FFF] text-white rounded-lg hover:from-[#6ba9d8] hover:to-[#0065cc]",disabled:u,children:u?"Chargement...":"Créer un compte"})}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Ou"})})]}),e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsx("div",{className:"w-full max-w-full",children:e.jsx($,{width:"100%",size:"large",text:"signup_with",shape:"rectangular",onSuccess:b,onError:v,useOneTap:!1})})})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Vous avez déjà un compte ?"," ",e.jsx("button",{type:"button",onClick:p,className:"text-[#007FFF] hover:underline font-medium",children:"Se connecter"})]})})]})},O=({onCancel:l})=>{const[p,b]=t.useState(!1),[v,i]=t.useState(""),[h,u]=t.useState(""),[o,x]=t.useState({email:""}),r=s=>{s.target===s.currentTarget&&l()},a=s=>{const{name:c,value:m}=s.target;x({...o,[c]:m})},j=async s=>{var c,m,d,g,f;s.preventDefault(),i(""),u("");try{if(b(!0),!o.email){i("Veuillez renseigner votre adresse email.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email)){i("Veuillez saisir une adresse email valide.");return}await F.forgotPassword(o),u("Un email de réinitialisation a été envoyé à votre adresse. Veuillez vérifier votre boîte de réception et vos spams. Le lien est valable pendant 1 heure."),x({email:""})}catch(n){((c=n.response)==null?void 0:c.status)===404?i("Aucun compte n'est associé à cette adresse email. Veuillez vérifier votre saisie ou créer un compte."):((m=n.response)==null?void 0:m.status)===400?i("Veuillez vérifier votre adresse email."):((d=n.response)==null?void 0:d.status)===429?i("Trop de tentatives. Veuillez patienter quelques minutes avant de réessayer."):i(((f=(g=n.response)==null?void 0:g.data)==null?void 0:f.message)||"Une erreur est survenue. Veuillez réessayer plus tard.")}finally{b(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",onClick:r,children:e.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-md mx-4 w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-teal-600",children:"Mot de passe oublié"}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Veuillez saisir votre adresse email. Vous recevrez un lien pour créer un nouveau mot de passe. Ce lien sera valable pendant 24 heure."}),v&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm mb-4",children:v}),h&&e.jsx("div",{className:"p-3 bg-green-100 border border-green-200 rounded-md text-green-600 text-sm mb-4",children:h}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Adresse email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(L,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",name:"email",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"votreemail@exemple.com",value:o.email,onChange:a,required:!0})]})]}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx("button",{type:"button",onClick:l,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Annuler"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-[#7CB9E8] to-[#007FFF] text-white rounded-lg hover:from-[#6BA8D7] hover:to-[#0066CC]",disabled:p,children:p?"Chargement...":"Envoyer"})]})]})]})})},W=({googleCredential:l,onCancel:p,inCart:b=!1})=>{const v=C(),{login:i}=k(),[h,u]=t.useState(!1),[o,x]=t.useState(""),[r,a]=t.useState({phoneNumber:"",companyName:"",siretNumber:""}),j=async s=>{var c,m,d,g,f;s.preventDefault(),x("");try{if(u(!0),!l)throw new Error("Session Google expirée. Veuillez réessayer.");const n=await F.registerWithGoogle(l,r);i(n),b||setTimeout(()=>{v("/inscription-reussie")},1e3)}catch(n){console.error("Erreur d'inscription Google:",n),(d=(m=(c=n.response)==null?void 0:c.data)==null?void 0:m.message)!=null&&d.includes("téléphone")?x("Le format du numéro de téléphone n'est pas valide. Utilisez le format +33XXXXXXXXX."):x(((f=(g=n.response)==null?void 0:g.data)==null?void 0:f.message)||"Une erreur est survenue lors de l'inscription.")}finally{u(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-md mx-4 w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-teal-600",children:"Informations supplémentaires requises"}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Pour finaliser votre inscription, veuillez fournir les informations suivantes :"}),o&&e.jsx("div",{className:"p-3 bg-red-100 border border-red-200 rounded-md text-red-600 text-sm mb-4",children:o}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Numéro de téléphone",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(J,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"tel",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"06 12 34 56 78",value:r.phoneNumber,onChange:s=>a({...r,phoneNumber:s.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nom de l'entreprise",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(H,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"Distritherm Services",value:r.companyName,onChange:s=>a({...r,companyName:s.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Numéro SIRET",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(K,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"w-full pl-10 px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"123 456 789 00012",value:r.siretNumber,onChange:s=>a({...r,siretNumber:s.target.value}),required:!0})]})]}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx("button",{type:"button",onClick:p,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Annuler"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-[#7CB9E8] to-[#007FFF] text-white rounded-lg hover:from-[#6BA8D7] hover:to-[#0066CC]",disabled:h,children:h?"Chargement...":"S'inscrire"})]})]})]})})},le=({inCart:l=!1,onSuccess:p})=>{const b=C(),{isAuthenticated:v,error:i,clearError:h}=k(),[u,o]=t.useState(!0),[x,r]=t.useState(""),[a,j]=t.useState(null),[s,c]=t.useState(null),[m,d]=t.useState(!1),[g,f]=t.useState(!1),[n,N]=t.useState(!1),[E,P]=t.useState(null),[y,Q]=t.useState("");t.useEffect(()=>{v&&(l&&p?p():b("/"))},[v,b,l,p]),t.useEffect(()=>{i&&(r(i),h())},[i,h]),t.useEffect(()=>{const w=new URLSearchParams(window.location.search).get("token");w&&(Q(w),N(!0),window.history.replaceState({},document.title,window.location.pathname))},[]);const z=async S=>{var w,T,U;try{if(r(""),!S.credential)throw new Error("Aucun credential Google reçu");c(S.credential),await F.loginWithGoogle(S.credential)}catch(X){((w=X.response)==null?void 0:w.status)===404?d(!0):r(((U=(T=X.response)==null?void 0:T.data)==null?void 0:U.message)||"Une erreur est survenue lors de la connexion avec Google.")}},R=()=>{r("La connexion avec Google a échoué. Veuillez réessayer ou utiliser le formulaire de connexion classique.")},q=()=>{o(!u),r("")},Y=()=>{f(!0),r("")},A=()=>{f(!1),r("")},D=()=>{N(!1),o(!0)},G=()=>{N(!1),o(!0)},V=()=>{d(!1),c(null),r("")},I=()=>e.jsx("section",{className:`relative ${l?"py-4":"py-20"} overflow-hidden`,children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"max-w-xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:u?"Connexion":"Inscription"}),e.jsx("p",{className:"text-gray-600",children:u?"Connectez-vous à votre compte pour continuer":"Créez un compte pour accéder à tous nos services"})]}),u?e.jsx(te,{inCart:l,onSwitchForm:q,onShowForgotPassword:Y,onGoogleSuccess:z,onGoogleError:R}):e.jsx(re,{inCart:l,onSwitchForm:q,onGoogleSuccess:z,onGoogleError:R})]})})})});return l?e.jsxs(e.Fragment,{children:[m&&s&&e.jsx(W,{googleCredential:s,onCancel:V,inCart:l}),g&&e.jsx(O,{onCancel:A}),n&&e.jsx(M,{token:y,onCancel:G,onSuccess:D}),I()]}):e.jsxs(se,{children:[m&&s&&e.jsx(W,{googleCredential:s,onCancel:V,inCart:l}),g&&e.jsx(O,{onCancel:A}),n&&e.jsx(M,{token:y,onCancel:G,onSuccess:D}),I()]})};export{le as default};
